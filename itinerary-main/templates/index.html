{% extends "headers.html" %}
{% block content %}

<main>
    <div class="container">
        <div class="row mb-4">
            <div class="col text-center">
                <h1>Travel Itinerary Generator</h1>
                <p class="lead">Fill in your preferences to generate a personalized travel plan.</p>
            </div>
        </div>

        <form action="/" method="POST">
            <div class="row">
                <div class="form-group col-md-6 mb-3">
                    <label for="source">From:</label>
                    <input type="text" class="form-control" name="source" id="source" placeholder="E.g., Mumbai" required>
                </div>
                <div class="form-group col-md-6 mb-3">
                    <label for="destination">To:</label>
                    <input type="text" class="form-control" name="destination" id="destination" placeholder="E.g., Paris" required>
                </div>
            </div>

            <div class="row">
                <div class="form-group col-md-6 mb-3">
                    <label for="date">Travel Date:</label>
                    <input type="date" class="form-control" name="date" id="date" required>
                </div>
                <div class="form-group col-md-6 mb-3">
                    <label for="return">Return Date:</label>
                    <input type="date" class="form-control" name="return" id="return" required>
                </div>
            </div>

            <div class="row">
                <div class="form-group col-md-6 mb-3">
                    <label for="adults">Adults</label>
                    <input type="number" class="form-control" id="adults" name="adults" min="1" value="1">
                </div>
                <div class="form-group col-md-6 mb-3">
                    <label for="children">Children</label>
                    <input type="number" class="form-control" id="children" name="children" min="0" value="0">
                </div>
            </div>

            <div class="form-group mb-3">
                <label>Budget</label><br>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="budget" id="budget_low" value="low" checked>
                    <label class="form-check-label" for="budget_low">Budget</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="budget" id="budget_mid" value="mid">
                    <label class="form-check-label" for="budget_mid">Mid-Range</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="budget" id="budget_high" value="high">
                    <label class="form-check-label" for="budget_high">Luxury</label>
                </div>
            </div>

            <div class="form-group mb-3">
                <label>Interests</label><br>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" name="interests" id="interest_adventure" value="adventure">
                    <label class="form-check-label" for="interest_adventure">Adventure</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" name="interests" id="interest_culture" value="culture">
                    <label class="form-check-label" for="interest_culture">Culture</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" name="interests" id="interest_food" value="food">
                    <label class="form-check-label" for="interest_food">Foodie</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" name="interests" id="interest_relaxation" value="relaxation">
                    <label class="form-check-label" for="interest_relaxation">Relaxation</label>
                </div>
            </div>

            <div class="text-center">
                <button type="submit" id="submit-button" class="btn btn-primary mt-3">Generate Itinerary</button>
                <div class="mt-3">
                    <img id="loading" style="display: none;" src="{{url_for('static',filename='loading.gif')}}" alt="Loading..." />
                </div>
            </div>
        </form>
    </div>
</main>

<div class="floating-container">
    <div class="floating-button">
        <i class="fa-solid fa-share-from-square"></i>
    </div>
    <div class="element-container">
        <a class="float-element" href="https://www.facebook.com/" target="_blank">
            <span><i class="fa-brands fa-facebook"></i></span>
        </a>
        <a class="float-element" href="https://api.whatsapp.com/send?" target="_blank">
            <span><i class="fa-brands fa-whatsapp"></i></span>
        </a>
        <a class="float-element" href="https://twitter.com/intent/tweet?" target="_blank">
            <span><i class="fa-brands fa-x-twitter"></i></span>
        </a>
        <a class="float-element" href="https://www.linkedin.com/" target="_blank">
            <span><i class="fa-brands fa-linkedin"></i></span>
        </a>
    </div>
</div>

<script>
    // Get references to the DOM elements
    const travelDateInput = document.getElementById('date');
    const returnDateInput = document.getElementById('return');
    const form = document.querySelector('form');
    const submitButton = document.getElementById('submit-button');
    const loadingGif = document.getElementById('loading');

    // --- Date Validation Logic ---
    // Set the minimum selectable travel date to today
    const today = new Date().toISOString().split('T')[0];
    travelDateInput.setAttribute('min', today);
    returnDateInput.setAttribute('min', today); // Also set min for return date initially

    // When the travel date changes, update the return date's minimum to prevent invalid ranges
    travelDateInput.addEventListener('change', function() {
        if (this.value) {
            returnDateInput.setAttribute('min', this.value);
            // If the current return date is before the new travel date, clear it
            if (returnDateInput.value < this.value) {
                returnDateInput.value = '';
            }
        }
    });

    // --- Form Submission Logic ---
    // Handle the loading state when the user submits the form
    form.addEventListener('submit', function() {
        // Show the loading GIF
        loadingGif.style.display = 'block';

        // Disable the button and change its text to provide feedback
        submitButton.disabled = true;
        submitButton.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Generating...';
    });
</script>

{% endblock %}